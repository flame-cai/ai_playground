(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{10:function(e,t,a){},14:function(e,t,a){e.exports=a(27)},22:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),l=a(12),r=a.n(l),c=(a(22),a(9)),s=a(3),i=(a(10),a(28));const m=Object(n.createContext)({token:null,setToken:()=>{}}),u=e=>{let{children:t}=e;const[a,l]=Object(n.useState)(localStorage.getItem("token")||null);return Object(n.useEffect)(()=>{a?(localStorage.setItem("token",a),console.log(a)):localStorage.removeItem("token")},[a]),o.a.createElement(m.Provider,{value:{token:a,setToken:l}},t)},g=()=>Object(n.useContext)(m);var p=e=>{let{temperature:t,maxTokens:a}=e;const[l,r]=Object(n.useState)([]),[c,s]=Object(n.useState)(""),[m,u]=Object(n.useState)(""),p=Object(n.useRef)(null),[d,E]=Object(n.useState)(null),{token:f}=g();Object(n.useEffect)(()=>{const e=localStorage.getItem("user");e&&E(JSON.parse(e))},[]),Object(n.useEffect)(()=>{d&&r([{role:"assistant",content:"Hello, I am GPT-4. AMA."}])},[d]),Object(n.useEffect)(()=>{p.current&&p.current.scrollIntoView({behavior:"smooth"})},[l]);return o.a.createElement("div",{className:"chat-container"},o.a.createElement("h1",null,"Conversation Tool"),o.a.createElement("hr",null),o.a.createElement("div",{className:"p-4 mb-4 border rounded"},o.a.createElement("h2",{className:"text-lg font-semibold mb-2"},"System Message"),o.a.createElement("textarea",{className:"w-full p-2 border rounded",value:m,onChange:e=>u(e.target.value),placeholder:"Enter system message here...",rows:"3"})),o.a.createElement("div",{className:"message-container"},l.map((e,t)=>{return o.a.createElement("div",{key:t,className:"message-row ".concat(e.role,"-row")},"assistant"===e.role&&o.a.createElement("div",{className:"profile-picture-container"},o.a.createElement("img",{src:"logo192.png",alt:"".concat(e.role," profile picture"),className:"profile-picture"})),o.a.createElement("div",{className:"message ".concat(e.role)},"string"===typeof(a=e.content)?o.a.createElement("p",null,a):a.map((e,t)=>{if("string"===typeof e&&e.startsWith("[Correction]"))return o.a.createElement("p",{key:t,className:"correction"},e.replace("[Correction]","").trim());if("string"===typeof e&&e.startsWith("[Response]"))try{let a=e.replace(/\\u([\dA-Fa-f]{4})/g,(e,t)=>String.fromCharCode(parseInt(t,16))).replace("[Response]","").trim().replace(/\(/g,"[").replace(/\)/g,"]").replace(/\\"/g,"").replace(/\\/g,"").replace(/,\s*\[/g,"--[").replace(/,/g,"--").replace(/----/g,",--").replace(/,--\s*--/g,",--,").replace(/--\]/g,",]").slice(1,-1),n=function(e){const t=[];let a=["",""];for(const[n,o]of e)".,!?".includes(n)?(a[0]+=n,a[1]+=o):(a[0]&&(t.push(a),a=["",""]),a=[n,o]);return a[0]&&t.push(a),t}(a.slice(2,-2).split("]--[").map(e=>e.split("--")));return console.log(a),console.log(n),o.a.createElement("p",{key:t,className:"text-container"},n.map((e,t)=>{let[a,n]=e;return o.a.createElement("span",{key:t,className:"hoverable-word"},a+" ",o.a.createElement("span",{className:"tooltiptext badge badge-light"},n))}))}catch(a){return console.error("Error parsing response:",a),o.a.createElement("p",{key:t},e)}else if("string"===typeof e&&e.startsWith("[Translation]"))return o.a.createElement("p",{key:t,className:"translation"},e.replace("[Translation]","").trim());return o.a.createElement("p",{key:t},e)})),"assistant"!==e.role&&o.a.createElement("div",{className:"profile-picture-container"},o.a.createElement("img",{src:"flame_img.jpeg",alt:"".concat(e.role," profile picture"),className:"profile-picture"})));var a}),o.a.createElement("div",{ref:p})),o.a.createElement("div",{className:"input-container"},o.a.createElement("input",{type:"text",value:c,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(async()=>{if(!c.trim())return;const e={role:"user",content:c};r(t=>[...t,e]),s("");try{const n=await i.a.post("https://asia-south1-ppt-tts.cloudfunctions.net/ai-backend/chat",{messages:[...l,e],systemMessage:m,temperature:parseFloat(t),maxTokens:parseInt(a)},{headers:{Authorization:"Bearer ".concat(f)}});console.log("Chat data:",f),console.log("Server response:",n.data),r(e=>[...e,n.data])}catch(n){console.error("Error sending message:",n)}})()},placeholder:"Type your message..."})))};var d=e=>{let{onLoginSuccess:t}=e;const[a,l]=Object(n.useState)(!1),{setToken:r}=g();return Object(n.useEffect)(()=>{(async()=>{await new Promise(e=>{if(document.querySelector("script#google-login"))return void e();const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.id="google-login",t.async=!0,t.defer=!0,t.onload=()=>e(),document.body.appendChild(t)}),l(!0)})()},[]),Object(n.useEffect)(()=>{if(a&&window.google){const e=async e=>{console.log("Encoded JWT ID token: "+JSON.stringify(e));try{const a=await i.a.post("https://asia-south1-ppt-tts.cloudfunctions.net/ai-backend/login",{},{headers:{Authorization:"Bearer ".concat(e.credential)}});console.log("Login success:",a.data),localStorage.setItem("token",e.credential),r(e.credential),t(a.data)}catch(a){console.error("Login failed:",a)}};window.google.accounts.id.initialize({client_id:"1066118926351-dskshp8i64e3e4i5rr76h85rfbhh5cc0.apps.googleusercontent.com",callback:e}),window.google.accounts.id.renderButton(document.getElementById("googleSignInDiv"),{theme:"outline",size:"large"})}},[a,t]),o.a.createElement("div",{id:"googleSignInDiv"})};var E=e=>{let{onLoginSuccess:t}=e;const[a,l]=Object(n.useState)(!1),[r,c]=Object(n.useState)(!1);return Object(n.useEffect)(()=>{1===window.performance.navigation.type&&c(!0)},[]),Object(n.useEffect)(()=>{const e=()=>{window.gapi&&window.gapi.accounts.id?l(!0):setTimeout(e,100)};if(e(),!r){const e=setTimeout(()=>{a||window.location.reload()},1e3);return()=>clearTimeout(e)}},[a,r]),o.a.createElement("div",{className:"login-container"},o.a.createElement("div",{className:"image-container"},o.a.createElement("img",{src:"./flame_img.jpeg",alt:"Logo 1",className:"logo-image"}),o.a.createElement("div",{className:"vertical-line"}),o.a.createElement("img",{src:"./CAI_logo.jpg",alt:"Logo 2",className:"logo-image"})),o.a.createElement("h1",null,"Welcome to the AI Language Practice Application"),o.a.createElement("p",null,"Please log in to continue"),o.a.createElement("div",{className:"google-signin-button"},o.a.createElement("div",{style:{display:"inline-block"}},o.a.createElement(d,{onLoginSuccess:t}))))};var f=e=>{let{user:t,children:a}=e;return t?a:o.a.createElement(s.a,{to:"/login",replace:!0})};var v=function(){const[e,t]=Object(n.useState)(null),[a,l]=Object(n.useState)(.3),[r,i]=Object(n.useState)(100),m=Object(n.useRef)(null),g=()=>{t(null),localStorage.removeItem("user"),clearTimeout(m.current),localStorage.removeItem("user"),localStorage.removeItem("token")},d=()=>{clearTimeout(m.current),m.current=setTimeout(()=>{alert("You have been logged out due to inactivity."),g()},36e5)};return Object(n.useEffect)(()=>{const e=localStorage.getItem("user");return e&&t(JSON.parse(e)),window.addEventListener("mousemove",d),window.addEventListener("keydown",d),()=>{window.removeEventListener("mousemove",d),window.removeEventListener("keydown",d),clearTimeout(m.current)}},[]),Object(n.useEffect)(()=>{e&&d()},[e]),o.a.createElement(u,null,o.a.createElement(c.a,null,o.a.createElement("div",{className:"App d-flex"},e&&o.a.createElement("nav",{className:"sidebar d-flex flex-column align-items-center"},o.a.createElement("div",{className:"logo my-3"},o.a.createElement("img",{src:"flame_img.jpeg",alt:"FLAME Logo",className:"img-fluid"})),o.a.createElement("hr",{className:"w-75"}),o.a.createElement("ul",{className:"nav flex-column w-100 text-center"},o.a.createElement("li",{className:"nav-item"},o.a.createElement(c.b,{to:"/conversation-companion",className:"nav-link"},"Conversation Tool"))),o.a.createElement("div",{className:"mt-auto w-100 p-3"},o.a.createElement("h3",{className:"text-center mb-3"},"Parameters"),o.a.createElement("div",{className:"mb-3"},o.a.createElement("label",{className:"d-block mb-2"},"Temperature: ",a),o.a.createElement("input",{type:"range",min:"0",max:"1",step:"0.1",value:a,onChange:e=>l(e.target.value),className:"w-100"})),o.a.createElement("div",null,o.a.createElement("label",{className:"d-block mb-2"},"Max Tokens: ",r),o.a.createElement("input",{type:"range",min:"0",max:"1000",step:"100",value:r,onChange:e=>i(e.target.value),className:"w-100"})))),o.a.createElement("div",{className:"content flex-grow-1"},e&&o.a.createElement("div",{className:"logout-container"},o.a.createElement("button",{onClick:g,className:"logout-button"},"Logout")),o.a.createElement(s.d,null,e?o.a.createElement(o.a.Fragment,null,o.a.createElement(s.b,{path:"/conversation-companion",element:o.a.createElement(f,{user:e},o.a.createElement(p,{temperature:a,maxTokens:r}))}),o.a.createElement(s.b,{path:"*",element:o.a.createElement(s.a,{to:"/conversation-companion"})})):o.a.createElement(o.a.Fragment,null,o.a.createElement(s.b,{path:"/login",element:o.a.createElement(E,{onLoginSuccess:e=>{const{token:a,expiresIn:n}=e;t(e),localStorage.setItem("user",JSON.stringify(e)),d()}})}),o.a.createElement(s.b,{path:"*",element:o.a.createElement(s.a,{to:"/login"})})))))))};var b=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,29)).then(t=>{let{getCLS:a,getFID:n,getFCP:o,getLCP:l,getTTFB:r}=t;a(e),n(e),o(e),l(e),r(e)})};r.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(u,null,o.a.createElement(v,null)))),b()}},[[14,1,2]]]);
//# sourceMappingURL=main.00eb20c5.chunk.js.map